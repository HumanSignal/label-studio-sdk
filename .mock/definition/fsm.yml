imports:
  root: __package__.yml
service:
  auth: false
  base-path: ''
  endpoints:
    state_history:
      path: /api/fsm/entities/{entity_name}/{entity_id}/history
      method: GET
      auth:
        - Token: []
      docs: Get the state history of an entity
      pagination:
        offset: $request.page
        results: $response.results
      source:
        openapi: openapi/openapi.yaml
      path-parameters:
        entity_name: string
        entity_id: integer
      display-name: Get entity state history
      request:
        name: FsmStateHistoryRequest
        query-parameters:
          created_at_from:
            type: optional<string>
            docs: >-
              Filter for state history items created at or after the ISO 8601
              formatted date (YYYY-MM-DDTHH:MM:SS)
          created_at_to:
            type: optional<string>
            docs: >-
              Filter for state history items created at or before the ISO 8601
              formatted date (YYYY-MM-DDTHH:MM:SS)
          ordering:
            type: optional<string>
            docs: Which field to use when ordering the results.
          page:
            type: optional<integer>
            docs: A page number within the paginated result set.
          page_size:
            type: optional<integer>
            docs: Number of results to return per page.
          previous_state:
            type: optional<string>
            docs: Filter previous_state by exact match (case-insensitive)
          state:
            type: optional<string>
            docs: Filter state by exact match (case-insensitive)
          transition_name:
            type: optional<string>
            docs: Filter transition_name by exact match (case-insensitive)
          triggered_by:
            type: optional<double>
            docs: Filter triggered_by by exact match
      response:
        docs: ''
        type: root.PaginatedStateModelList
        status-code: 200
      examples:
        - path-parameters:
            entity_name: entity_name
            entity_id: 1
          query-parameters:
            created_at_from: created_at_from
            created_at_to: created_at_to
            ordering: ordering
            page: 1
            page_size: 1
            previous_state: previous_state
            state: state
            transition_name: transition_name
            triggered_by: 1.1
          response:
            body:
              count: 123
              next: http://api.example.org/accounts/?page=4
              previous: http://api.example.org/accounts/?page=2
              results:
                - context_data:
                    key: value
                  created_at: '2024-01-15T09:30:00Z'
                  id: id
                  previous_state: previous_state
                  state: state
                  transition_name: transition_name
      audiences:
        - internal
    execute_transition:
      path: /api/fsm/entities/{entity_name}/{entity_id}/transition/
      method: POST
      auth:
        - Token: []
      docs: Execute a registered manual transition for an entity.
      source:
        openapi: openapi/openapi.yaml
      path-parameters:
        entity_name: string
        entity_id: integer
      display-name: Execute manual FSM transition
      request:
        name: FsmTransitionExecuteRequestRequest
        body:
          properties:
            transition_data: optional<map<string, unknown>>
            transition_name:
              type: string
              validation:
                minLength: 1
        content-type: application/json
      response:
        docs: ''
        type: root.FsmTransitionExecuteResponse
        status-code: 200
      examples:
        - path-parameters:
            entity_name: entity_name
            entity_id: 1
          request:
            transition_name: transition_name
          response:
            body:
              new_state: new_state
              state_record:
                context_data:
                  key: value
                created_at: '2024-01-15T09:30:00Z'
                id: id
                previous_state: previous_state
                state: state
                transition_name: transition_name
                triggered_by:
                  email: email
                  id: 1
              success: true
      audiences:
        - internal
  source:
    openapi: openapi/openapi.yaml
